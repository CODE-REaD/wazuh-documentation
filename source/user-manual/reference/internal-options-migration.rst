.. Copyright (C) 2019 Wazuh, Inc.

.. _reference_internal_options_migration:

Internal options migration
==========================

In this section, a table will be shown to ease the migration of the the old :ref:`internal options <reference_internal_options>` to their new equivalences in ``ossec.conf``.

In the following table it's indicated the section and the subsection (it may not have one) where each option belongs and its name in ``ossec.conf``. These three things are related to the option original name in the deprecated ``internal_option`` file.

+-------------------------+----------------+----------------------------+------------------------------------------+
| **Section**             | **Subsection** | **Option**                 | **internal_options**                     |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <agentless>            |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <default_timeframe>       |    analysisd.default_timeframe           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <stats>        |  <maxdiff>                 |    analysisd.stats_maxdiff               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <stats>        |  <mindiff>                 |    analysisd.stats_mindiff               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <stats>        |  <percent_diff>            |    analysisd.stats_percent_diff          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <fts>          |  <list_size>               |    analysisd.fts_list_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <fts>          |  <fts_min_size_for_str>    |    analysisd.fts_min_size_for_str        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <log_fw>                  |    analysisd.log_fw                      |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <decoder_order_size>      |    analysisd.decoder_order_size          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <geoip_jsonout>           |    analysisd.geoip_jsonout               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <labels>       |  <cache_maxage>            |    analysisd.label_cache_maxage          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <labels>       |  <show_hidden>             |    analysisd.show_hidden_labels          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <rlimit_nofile>           |    analysisd.rlimit_nofile               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <min_rotate_internal>     |    analysisd.min_rotate_internal         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <event>                   |    analysisd.event_threads               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <syscheck>                |    analysisd.syscheck_threads            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <syscollector>            |    analysisd.syscollector_threads        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <rootcheck>               |    analysisd.rootcheck_threads           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <sca>                     |    analysisd.sca_threads                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <hostinfo>                |    analysisd.hostinfo_threads            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <winevent>                |    analysisd.winevt_threads              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <threads>      |  <rule_matching>           |    analysisd.rule_matching_threads       |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <event>                   |    analysisd.decode_event_queue_size     |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <syscheck>                |    analysisd.decode_syscheck_queue_size  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <syscollector>            | analysisd.decode_syscollector_queue_size |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <rootcheck>               |    analysisd.decode_rootcheck_queue_size |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <sca>                     |    analysisd.decode_sca_queue_size       |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <hostinfo>                |    analysisd.decode_hostinfo_queue_size  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <winevent>                |    analysisd.decode_winevt_queue_size    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <output>                  |    analysisd.decode_output_queue_size    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <archive>                 |    analysisd.archives_queue_size         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <statistical>             |    analysisd.statistical_queue_size      |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <alerts>                  |    analysisd.alerts_queue_size           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <firewall>                |    analysisd.firewall_queue_size         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             | <queue_size>   |  <fts>                     |    analysisd.fts_queue_size              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <state_interval>          |    analysisd.state_interval              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <analysis>             |                |  <log_level>               |    analysisd.debug                       |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <auth>                 | <timeout>      |  <seconds>                 |    authd.timeout_seconds                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <auth>                 | <timeout>      |  <microseconds>            |    authd.timeout_microseconds            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <auth>                 |                |  <log_level>               |    authd.debug                           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <state_interval>          |    agent.state_interval                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <recv_timeout>            |    agent.recv_timeout                    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <remote_conf>             |    agent.remote_conf                     |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <max_attempts>            |    agent.max_attempts                    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <recv_counter_flush>      |    remoted.recv_counter_flush            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <comp_avg_printout>       |    remoted.comp_average_printout         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <verify_msg_id>           |    remoted.verify_msg_id                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               |                |  <log_level>               |    agent.debug / windows.debug           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               | <request>      |  <rto_sec>                 |    remoted.request_rto_sec               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               | <request>      |  <rto_msec>                |    remoted.request_rto_msec              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client>               | <request>      |  <pool>                    |    remoted.request_pool                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client_buffer>        |                |  <tolerance>               |    agent.tolerance                       |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client_buffer>        |                |  <min_eps>                 |    agent.min_eps                         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client_buffer>        |                |  <warn_level>              |    agent.warn_level                      |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <client_buffer>        |                |  <normal_level>            |    agent.normal_level                    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <cluster>              |                |  <log_level>               |    wazuh_clusterd.debug                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <csyslog>              |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <sync_agents>             |    wazuh_database.sync_agents            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <sync_rootcheck>          |    wazuh_database.sync_rootcheck         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <full_sync>               |    wazuh_database.full_sync              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <real_time>               |    wazuh_database.real_time              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <interval>                |    wazuh_database.interval               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             | <global_db>    |  <max_queued_events>       |    wazuh_database.max_queued_events      |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <worker_pool_size>        |    wazuh_db.worker_pool_size             |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <commit_time>             |    wazuh_db.commit_time                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <open_db_limit>           |    wazuh_db.open_db_limit                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <rlimit_nofile>           |    wazuh_db.rlimit_nofile                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database>             |                |  <log_level>               |    wazuh_db.debug                        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <database_output>      |                |  <reconnect_attempts>      |    dbd.reconnect_attempts                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <download>             |                |  <enabled>                 |    wazuh_download.enabled                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <exec>                 |                |  <request_timeout>         |    execd.request_timeout                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <exec>                 |                |  <max_restart_lock>        |    execd.max_restart_lock                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <exec>                 |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <exec>                 |                |  <log_level>               |    execd.debug                           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <integrator>           |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <integrator>           |                |  <log_level>               |    integrator.debug                      |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <remote_commands>         |    logcollector.remote_commands          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <sock_fail_time>          |    logcollector.sock_fail_time           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <queue_size>              |    logcollector.queue_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <sample_log_length>       |    logcollector.sample_log_length        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <log_level>               |    logcollector.debug                    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <loop_timeout>            |    logcollector.loop_timeout             | 
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <open_attempts>           |    logcollector.open_attempts            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <vcheck>                  |    logcollector.vcheck_files             |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <max_lines>               |    logcollector.max_lines                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <max_files>               |    logcollector.max_files                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <input_threads>           |    logcollector.input_threads            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <rlimit_nofile>           |    logcollector.rlimit_nofile            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <files>        |  <exclude_interval>        |    logcollector.exclude_files_interval   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <reload>       |  <force>                   |    logcollector.force_reload             |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <reload>       |  <interval>                |    logcollector.reload_interval          |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <logcollector>         | <reload>       |  <delay>                   |    logcollector.reload_delay             |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <mail>                 |                |  <strict_checking>         |    maild.strict_checking                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <mail>                 |                |  <grouping>                |    maild.grouping                        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <mail>                 |                |  <full_subject>            |    maild.full_subject                    |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <mail>                 |                |  <geoip>                   |    maild.geoip                           |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <mail>                 |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <modules>              |                |  <task_nice>               |    wazuh_modules.task_nice               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <modules>              |                |  <max_eps>                 |    wazuh_modules.max_eps                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <modules>              |                |  <kill_timeout>            |    wazuh_modules.kill_timeout            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <modules>              |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <modules>              |                |  <log_level>               |    wazuh_modules.debug                   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <recv_counter_flush>      |    remoted.recv_counter_flush            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <comp_average_printout>   |    remoted.comp_average_printout         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <verify_msg_id>           |    remoted.verify_msg_id                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <pass_empty_keyfile>      |    remoted.pass_empty_keyfile            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <pool>         |  <sender>                  |    remoted.sender_pool                   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <pool>         |  <request>                 |    remoted.request_pool                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <timeout>      |  <request>                 |    remoted.request_timeout               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <timeout>      |  <response>                |    remoted.response_timeout              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <request>      |  <rto_sec>                 |    remoted.request_rto_sec               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <request>      |  <rto_msec>                |    remoted.request_rto_msec              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <timeout>      |  <max_attempts>            |    remoted.max_attempts                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <shared>       |  <shared_reload>           |    remoted.shared_reload                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <rlimit_nofile>           |    remoted.rlimit_nofile                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <timeout>      |  <recv>                    |    remoted.request_rto_sec               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <timeout>      |  <send>                    |    remoted.request_rto_msec              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <shared>       |  <merge>                   |    remoted.merge_shared                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <interval>     |  <keyupdate>               |    remoted.keyupdate_interval            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <pool>         |  <worker_pool>             |    remoted.worker_pool                   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <interval>     |  <state>                   |    remoted.state_interval                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <group>        |  <guess_agent>             |    remoted.guess_agent_group             |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <group>        |  <data_flush>              |    remoted.group_data_flush              |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <memory>       |  <receive_chunk>           |    remoted.receive_chunk                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <memory>       |  <buffer_relax>            |    remoted.buffer_relax                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <tcp>          |  <keepidle>                |    remoted.tcp_keepidle                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <tcp>          |  <keepintvl>               |    remoted.tcp_keepintvl                 |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               | <tcp>          |  <keepcnt>                 |    remoted.tcp_keepcnt                   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <remote>               |                |  <log_level>               |    remoted.debug                         |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <rootcheck>            |                |  <sleep>                   |    rootcheck.sleep                       |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <sca>                  |                |  <request_db_interval>     |    sca.request_db_interval               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <sca>                  | <commands>     |  <remote>                  |    sca.remote_commands                   |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <sca>                  | <commands>     |  <timeout>                 |    sca.commands_timeout                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <sleep>                   |    syscheck.sleep                        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <sleep_after>             |    syscheck.sleep_after                  |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <rt_delay>                |    syscheck.rt_delay                     |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <max_fd_win_rt>           |    syscheck.max_fd_win_rt                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <max_audit_entries>       |    syscheck.max_audit_entries            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <default_max_depth>       |    syscheck.default_max_depth            |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <symlink_scan_interval>   |    syscheck.symlink_scan_interval        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <file_max_size>           |    syscheck.file_max_size                |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <thread_stack_size>       |    wazuh.thread_stack_size               |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <syscheck>             |                |  <log_level>               |    syscheck.debug                        |
+-------------------------+----------------+----------------------------+------------------------------------------+
|  <wodle=command>        |                |  <remote_commands>         |    wazuh_command.remote_commands         |
+-------------------------+----------------+----------------------------+------------------------------------------+